---
title: "Poročilo pri predmetu Analiza podatkov s programom R"
author: "Nino Cajnkar"
output:
  html_document: default
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
runtime: shiny
---

```{r setup, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE)
# Uvoz vseh potrebnih knjižnic
source("libraries/libraries.r", encoding="UTF-8")
```


## Izbira teme
V prvi fazi sem si izbral temo prometnih nesreč v Sloveniji zadnjih 15 let. Izbral sem podatke iz dveh virov, uradne podatke Policije Slovenije, kjer so podatki sicer že bili v CSV datoteki, vendar zbrani po posameznih letih, ter iz spletne strani statističnega urada Slovenije. Med drugim sem uporabil tudi seznam Policijskih postaj najden na spletni strani Slovenske Policije, kjer sem moral imena zbrati iz pdf datoteke.
# Spletne povezave do podatkov:
[Statistični_Urad](<https://pxweb.stat.si/SiStatData/pxweb/sl/Data/Data/2222003S.px/##>)
[Slovenska_Policija](<https://www.policija.si/o-slovenski-policiji/statistika/prometna-varnost>)
[Seznam_Policijskih_Postaj](https://www.policija.si/images/stories/O_Policiji/Seznam_vseh_PP_01122017.pdf)
***

## Obdelava, uvoz in čiščenje podatkov

```{r uvoz}
source("uvoz/uvoz.r", encoding="UTF-8")
```
V drugi fazi sem uvozil tabele s podatki v CSV obliki, ki sem jih dobil na strani Slovenske Policije, ter nato še tabelo s podatki v obliki CSV iz statističnega urada Republike Slovenije. Z uporabo podatkov iz tabele, sem naredil še nekaj grafov, ki prikazujejo število nesreč glede na vzrok, tip nesreče, vreme v času nesreče, vrsto ceste, alkoholiziranost udeleženca ter skupen seštevek nesreč. Iz grafov je razvidno, da je število prometnih nesreč z leti upadalo, v letu 2020 je sicer bilo precej manj nesreč zaradi vpliva karantene (kar bi se najverjetneje še bolj opazilo v let0 2021, če bi podatki že bili objavljeni), zaradi česar pride do manjših odstopanj v fazi analize. Vsi podatki so seveda v obliki *tidy data*.

1. TABELA : Podatki o prometnih nesrečah med 2005 in 2020
- "zaporedna_stevilka" (numeric),
- "klasifikacija"(character),
- "postaja" (character),
- "datum",
- "ura",
- "v_naselju" (character),
- "lokacija" (character),
- "vrsta_ceste_naselja" (character),
- "sifra_ceste_naselja" (numeric),
- "tekst_cesta_naselje" (character),
- "sifra_odseka_ulice" (numeric),
- "tekst_odseka_ulice" (character),
- "stacionaza" (numeric),
- "opis" (character),
- "vzrok" (character),
- "tip" (character),
- "vreme" (character),
- "stanje_prometa" (character),
- "stanje_vozisca" (character),
- "vrsta_vozisca" (character),
- "longitude" (numeric),
- "latitude"(numeric),
- "zap_st_osebe" (numeric),
- "povzrocitelj" (character),
- "starost" (numeric),
- "spol" (character),
- "UE_stalnega_prebivalisca" (character),
- "drzavljanstvo" (character),
- "poskodba_udelezenca" (character),
- "vrsta_udelezenca" (character),
- "varnostni_pas" (character),
- "vozniski_staz_leta" (numeric),
- "vozniski_staz_mesec" (numeric),
- "alkotest" (numeric),
- "pregled" (numeric)

2. TABELA: Podatki po mesecih, za vsako leto so 4 spremenljivke:
- "skupaj" (Numeric),
- "smrtni_izid" (Numeric),
- "telesna_poskodba" (Numeric),
- "materialna_skoda" (Numeric)

***

## Analiza in vizualizacija podatkov

```{r vizualizacija, results='hide'}
source("vizualizacija/vizualizacija.r", encoding="UTF-8")
```

Graf števila prometnih nesreč v letih 2005-2020:

```{r histogram1, fig.align='center'}
graf_po_letih
```
Graf števila prometnih nesreč glede na alkoholiziranost:

```{r histogram2, fig.align='center'}
nesrece_alkohol
```
Graf števila prometnih nesreč glede na pristojnosti Policijskih Uprav:

```{r histogram3, fig.align='center'}
graf_nesrece
```
Graf števila prometnih nesreč glede na tip nesreče:

```{r histogram4, fig.align='center'}
graf_tipi
```
Graf števila prometnih nesreč glede na vreme:

```{r histogram5, fig.align='center'}
graf_vremena
```
Graf števila prometnih nesreč glede vrsto vozišča:

```{r histogram6, fig.align='center'}
graf_vrste
```
Graf števila prometnih nesreč glede stanje vozišča:

```{r histogram7, fig.align='center'}
graf_stanja
```
Graf števila prometnih nesreč glede vzrok nesreče:

```{r histogram8, fig.align='center'}
graf_vzroki
```


***

## Napredna analiza podatkov

```{r analiza}
source("analiza/analiza.r", encoding="UTF-8")
```
Za četrto fazo sem se odločil, da bom v prvem delu predvideval kako se bo število nesreč spreminjalo v prihodnjih petih letih:

```{r histogram9, fig.align='center'}
graf_predict
```
Po predikciji predikcijske črte bi se število nesreč naj začelo ponovno višati, kar se mi ne zdi najbolj realna predstava, saj bi se število nesreč po mojem mnenju moralo sorazmerno manjšati
do neke spodnje meje, podatki bi padali logaritemsko. Seveda pa težko pridemo do zaključkov, zaradi premajhnega časovnega intervala.

V drugem grafu pa sem naredil predikcijo prometnih nesreč za leta 2016 do 2020 iz podatkov na statističnem uradu, ki so sicer le do leta 2015. 
Tako sem preveril skladnost podatkov Slovenske Policije za leta 2016 do 2020 s predikcijo spreminjanja števila prometnih nesreč podatkov iz statističnega urada.
Zaključimo lahko, da v zadnjih 5 letih ni prišlo do bistvenega odstopanja od pričakovanih, prikazanih na grafu s črnimi in rdečimi točkami.
```{r histogram10, fig.align='center'}
graf_predict2
```
***
